# Webhook é…ç½®

æœ¬æœåŠ¡æ”¯æŒé€šè¿‡ Webhook æ¥æ”¶æ¥è‡ª Embyã€Jellyfinã€Plex ç­‰åª’ä½“æœåŠ¡å™¨çš„é€šçŸ¥ï¼Œå®ç°æ–°åª’ä½“å…¥åº“åçš„å¼¹å¹•è‡ªåŠ¨æœç´¢å’Œå¯¼å…¥ã€‚

![Webhookç®¡ç†](/screenshot/webhookç®¡ç†.png)

## 1. è·å– Webhook URL

1. åœ¨ Web UI çš„ "è®¾ç½®" -> "Webhook" é¡µé¢ï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªä¸ºæ‚¨ç”Ÿæˆçš„å”¯ä¸€çš„ **API Key**ã€‚
2. æ ¹æ®æ‚¨è¦é›†æˆçš„æœåŠ¡ï¼Œå¤åˆ¶å¯¹åº”çš„ Webhook URLã€‚URL çš„é€šç”¨æ ¼å¼ä¸ºï¼š
   ```
   http://<æœåŠ¡å™¨IP>:<ç«¯å£>/api/webhook/{æœåŠ¡å}?api_key=<ä½ çš„API_Key>
   ```

   - `<æœåŠ¡å™¨IP>`: éƒ¨ç½²æœ¬æœåŠ¡çš„ä¸»æœº IP åœ°å€ã€‚
   - `<ç«¯å£>`: éƒ¨ç½²æœ¬æœåŠ¡æ—¶è®¾ç½®çš„ç«¯å£ï¼ˆé»˜è®¤ä¸º `7768`ï¼‰ã€‚
   - `{æœåŠ¡å}`: webhookç•Œé¢ä¸­ä¸‹æ–¹å·²åŠ è½½çš„æœåŠ¡åç§°ï¼Œä¾‹å¦‚ `emby`ã€`jellyfin`ã€`plex`ã€‚
   - `<ä½ çš„API_Key>`: æ‚¨åœ¨ Webhook è®¾ç½®é¡µé¢è·å–çš„å¯†é’¥ã€‚
3. ç°åœ¨å·²ç»å¢åŠ æ‹¼æ¥URLåçš„å¤åˆ¶æŒ‰é’®

## 2. é…ç½®åª’ä½“æœåŠ¡å™¨

### å¯¹äº Emby

1. ç™»å½•æ‚¨çš„ Emby æœåŠ¡å™¨ç®¡ç†åå°ã€‚
2. å¯¼èˆªåˆ° **é€šçŸ¥** (Notifications)ã€‚
3. ç‚¹å‡» **æ·»åŠ é€šçŸ¥** (Add Notification)ï¼Œé€‰æ‹© **Webhook** ç±»å‹ã€‚
4. åœ¨ **Webhook URL** å­—æ®µä¸­ï¼Œå¡«å…¥æ‚¨çš„ Emby Webhook URLï¼Œä¾‹å¦‚ï¼š
   ```
   http://192.168.1.100:7768/api/webhook/emby?api_key=your_webhook_api_key_here
   ```
5. **å…³é”®æ­¥éª¤**: åœ¨ **äº‹ä»¶** (Events) éƒ¨åˆ†ï¼Œè¯·åŠ¡å¿…**åªå‹¾é€‰**ä»¥ä¸‹äº‹ä»¶ï¼š
   - **é¡¹ç›®å·²æ·»åŠ  (Item Added)**: è¿™æ˜¯æ–°åª’ä½“å…¥åº“çš„äº‹ä»¶ï¼Œå…¶å¯¹åº”çš„äº‹ä»¶åä¸º `æ–°åª’ä½“æ·»åŠ `ã€‚
6. ç¡®ä¿ **å‘é€å†…å®¹ç±»å‹** (Content type) è®¾ç½®ä¸º `application/json`ã€‚
7. ä¿å­˜è®¾ç½®ã€‚

### å¯¹äº Jellyfin

1. ç™»å½•æ‚¨çš„ Jellyfin æœåŠ¡å™¨ç®¡ç†åå°ã€‚
2. å¯¼èˆªåˆ° **æˆ‘çš„æ’ä»¶**ï¼Œæ‰¾åˆ° **Webhook** æ’ä»¶ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œè¯·å…ˆå®‰è£…æ’ä»¶ï¼Œå¹¶é‡å¯æœåŠ¡å™¨ã€‚
3. ç‚¹å‡» **Webhook** æ’ä»¶ï¼Œè¿›å…¥é…ç½®é¡µé¢ã€‚
4. åœ¨ **Server Url** ä¸­è¾“å…¥jellyfin è®¿é—®åœ°å€ï¼ˆå¯é€‰ï¼‰ã€‚
5. ç‚¹å‡» **Add Generic Destination**ã€‚
6. è¾“å…¥ **Webhook Name**
7. åœ¨ **Webhook URL** å­—æ®µä¸­ï¼Œå¡«å…¥æ‚¨çš„ Jellyfin Webhook URLï¼Œä¾‹å¦‚ï¼š
   ```
   http://192.168.1.100:7768/api/webhook/jellyfin?api_key=your_webhook_api_key_here
   ```
8. **å…³é”®æ­¥éª¤**: åœ¨ **Notification Type** éƒ¨åˆ†ï¼Œè¯·åŠ¡å¿…**åªå‹¾é€‰**ä»¥ä¸‹äº‹ä»¶ï¼š
   - **Item Added**: è¿™æ˜¯æ–°åª’ä½“å…¥åº“çš„äº‹ä»¶ï¼Œå…¶å¯¹åº”çš„äº‹ä»¶åä¸º `æ–°åª’ä½“æ·»åŠ `ã€‚
9. **å…³é”®æ­¥éª¤**: ä¸€å®šè¦å‹¾é€‰ **Send All Properties (ignores template)** é€‰é¡¹ã€‚
10. ä¿å­˜è®¾ç½®ã€‚

### å¯¹äº Plex

#### æ–¹å¼ä¸€ï¼šPlex åŸç”Ÿ Webhooksï¼ˆéœ€è¦ Plex Passï¼Œæœ‰å±€é™æ€§ï¼‰

1. ç™»å½•æ‚¨çš„ Plex æœåŠ¡å™¨ç®¡ç†åå°ã€‚
2. å¯¼èˆªåˆ° **è®¾ç½®** -> **Webhooks**ã€‚
3. ç‚¹å‡» **æ·»åŠ  Webhook**ã€‚
4. åœ¨ **URL** å­—æ®µä¸­ï¼Œå¡«å…¥æ‚¨çš„ Plex Webhook URLï¼Œä¾‹å¦‚ï¼š
   ```
   http://192.168.1.100:7768/api/webhook/plex?api_key=your_webhook_api_key_here
   ```
5. ä¿å­˜è®¾ç½®ã€‚

> **âš ï¸ é‡è¦é™åˆ¶**:
> - **éœ€è¦ Plex Pass è®¢é˜…**
> - **æ— æ³•å¤„ç†æ‰¹é‡å…¥åº“**ï¼šå½“æ‚¨ä¸€æ¬¡æ€§æ·»åŠ å¤šé›†å‰§é›†æ—¶ï¼ˆå¦‚ç¬¬1-7é›†ï¼‰ï¼ŒPlex åŸç”Ÿ webhook åªä¼šå‘é€ä¸€ä¸ªå‰§é›†çº§åˆ«çš„é€šçŸ¥ï¼Œæ— æ³•è·å–å…·ä½“çš„é›†æ•°ä¿¡æ¯
> - æœ¬æœåŠ¡åªä¼šå¤„ç† `library.new` äº‹ä»¶ï¼ˆæ–°åª’ä½“å…¥åº“ï¼‰ï¼Œå…¶ä»–äº‹ä»¶ä¼šè¢«å¿½ç•¥

#### æ–¹å¼äºŒï¼šé€šè¿‡ Tautulliï¼ˆå¼ºçƒˆæ¨èï¼‰

**ä¸ºä»€ä¹ˆæ¨è Tautulliï¼Ÿ**
- âœ… **è§£å†³æ‰¹é‡å…¥åº“é—®é¢˜**ï¼šå®Œç¾å¤„ç†è¿ç»­å‰§é›†å…¥åº“ï¼ˆå¦‚ä¸€æ¬¡æ€§æ·»åŠ ç¬¬1-7é›†ï¼‰
- âœ… **æ— éœ€ Plex Pass**ï¼šå…è´¹ä½¿ç”¨ï¼Œæ— è®¢é˜…è¦æ±‚
- âœ… **ç²¾ç¡®äº‹ä»¶æ§åˆ¶**ï¼šåªåœ¨çœŸæ­£éœ€è¦æ—¶è§¦å‘ï¼Œå‡å°‘æ— ç”¨è¯·æ±‚

**è¯¦ç»†é…ç½®æ­¥éª¤ï¼š**

1. **å®‰è£… Tautulli**
   - è®¿é—® [Tautulli å®˜ç½‘](https://tautulli.com/) ä¸‹è½½å¹¶å®‰è£…
   - é…ç½® Tautulli è¿æ¥åˆ°æ‚¨çš„ Plex æœåŠ¡å™¨

2. **åˆ›å»º Webhook é€šçŸ¥**
   - ç™»å½• Tautulli ç®¡ç†åå°
   - å¯¼èˆªåˆ° **Settings** -> **Notification Agents**
   - ç‚¹å‡» **Add a new notification agent**ï¼Œé€‰æ‹© **Webhook**

3. **Configuration æ ‡ç­¾é¡µé…ç½®**
   - **Webhook URL**: å¡«å…¥æ‚¨çš„ Plex Webhook URLï¼š
     ```
     http://192.168.1.100:7768/api/webhook/plex?api_key=your_webhook_api_key_here
     ```
   - **Webhook Method**: é€‰æ‹© `POST`

4. **Triggers æ ‡ç­¾é¡µé…ç½®**
   - å‹¾é€‰ **Recently Added**ï¼ˆæ–°åª’ä½“å…¥åº“äº‹ä»¶ï¼‰
   - å…¶ä»–äº‹ä»¶ä¿æŒä¸å‹¾é€‰

5. **Data æ ‡ç­¾é¡µé…ç½®**
   - å±•å¼€ **Recently Added** éƒ¨åˆ†
   - åœ¨ **JSON Data** å­—æ®µä¸­å¡«å…¥ä»¥ä¸‹æ¨¡æ¿ï¼š
     ```json
     {
       "media_type": "{media_type}",
       "title": "{title}",
       "show_name": "{show_name}",
       "season": "{season_num}",
       "episode": "{episode_num}",
       "release_date": "{air_date}",
       "user_name": "{username}",
       "action": "created"
     }
     ```

6. **ä¿å­˜å¹¶æµ‹è¯•**
   - ç‚¹å‡» **Save** ä¿å­˜é…ç½®
   - å¯ä»¥ä½¿ç”¨ **Test** åŠŸèƒ½éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **[ğŸ¬ å…ƒæ•°æ®æºé…ç½®](/config/å…ƒæ•°æ®æºé…ç½®)** - æé«˜åŒ¹é…å‡†ç¡®ç‡
- **[ğŸ¤– AI åŠŸèƒ½é…ç½®](/config/AIåŠŸèƒ½é…ç½®)** - AI è¾…åŠ©è¯†åˆ«
- **[â“ å¸¸è§é—®é¢˜](/å¸¸è§é—®é¢˜)** - æ•…éšœæ’é™¤

